# VisitSheet-Automation

![Excel VBA](https://img.shields.io/badge/-Excel%20VBA-217346?logo=microsoft-excel&logoColor=white)
![Automation](https://img.shields.io/badge/-Automation-blue)
![Portfolio](https://img.shields.io/badge/-Portfolio-black)

訪問パターンブックからご利用者ごとの予定表を自動生成・転記するVBAスクリプトです。


# Excel VBA｜訪問予定表 自動転記システム

## 🧩 概要
このプロジェクトは、**訪問予定表（看護）ファイル群**を自動生成・自動転記するためのExcel VBAスクリプトです。  
「訪問パターン」ブック内の各シートをデータソースとし、同フォルダ内の同名 `.xlsm` ファイルへ自動的に原本コピー・転記・保存を行います。
原本シートのコピー・日付判断・月ごとのスケジュール配置を完全自動化します。
※ファイル名・ファイル内の全ての個人情報等は全て偽名です。

---

## ⚙️ 主な処理内容

| 処理 | 内容 |
|------|------|
| ① ファイル検出 | アクティブブックと同じフォルダ内で、シート名と一致する `.xlsm` ファイルを検索 |
| ② 原本コピー | 各ファイルの「原本」シートをコピーし、新しいシートを作成 |
| ③ 氏名転記 | 新シートの **A3** に「シート名 様」を自動入力（半角スペース付き） |
| ④ 月数転記 | 一括作成シートの **A1** の値（例：11）を **G5** に転記 |
| ⑤ シート名変更 | 新しいシートを「11月」などにリネーム |
| ⑥ 転記実行 | 3段階の転記ロジック（`ApplyOriginalLogic`, `secondprg`, `thirdprg`）を実行 |
| ⑦ 保存・終了 | 自動保存して次のシートへ進む（エラー時もスキップ処理） |
| ① ご利用者検出 | 「一括作成」「シート検索」以外の各ご利用者シートを順番に処理 |
| ② 転記先判定 | 同フォルダ内で、シート名と同名の `.xlsm` ファイル（例：田中.xlsm）を検索 |
| ③ 原本コピー | 開いた訪問予定表ファイル内の「原本」シートをコピーして新しいシートを作成 |
| ④ 共通情報転記 | A3に「ご利用者 様」、G5に一括作成シートA1の月数を転記 |
| ⑤ シート名変更 | 新シートを「11月」などにリネーム |
| ⑥ スケジュール転記 | 各ご利用者シート（転記元）の予定を、日付列と月を照合して訪問予定表に反映 |
| ⑦ 保存・終了 | 保存して閉じ、次のご利用者へ進む（エラー時もスキップ） |

---

## 🧭 使い方
## 📂 フォルダ構成例

### 🔹 事前準備
1. フォルダを作成し、以下のようにファイルを配置：
2. **「VisitPattern.xlsm」** の「一括作成」シートA1に対象月（例：11）を入力。
3. 各担当者ごとのシート（田中、佐藤、鈴木など）を作成。
---

## 🧭 処理イメージ
| 役割 | 対象 | 内容 |
|------|------|------|
| 転記元 | VisitPattern.xlsm（各ご利用者シート） | ご利用者ごとのスケジュール情報を入力する |
| 転記先 | 各ご利用者の訪問予定表ファイル | 原本を複製し、月間スケジュールを自動反映する |
| 原本 | ■訪問予定表(原本)■.xlsm | 転記先ファイルが参照するテンプレート |

---

### 🔹 実行手順
1. Excelで「VisitPattern.xlsm」を開く。  
2. 「一括作成」シートに対象月を入力し「訪問表作成ボタン」をクリック。
3. 各 `.xlsm` ファイルが順に開かれ、「原本」シートがコピー・転記・保存される。  
4. 新シートには以下が反映される：  
- A3 → `田中 様`  
- G5 → `11`  
- シート名 → `11月`
## 💡 転記ロジック（自動反映の仕組み）

| サブルーチン | 機能概要 |
|---------------|-----------|
| `ApplyOriginalLogic` | 転記先シート内の日付セルと転記元の月を照合し、対応するブロックにデータを挿入 |
| `secondprg` | 週単位のスケジュール転記。対象月の日付を抽出し、対応行に値を転記 |
| `thirdprg` | 冒頭週および末尾週の追加スケジュールを配置し、月末処理まで対応 |

---

## 💾 GitHubへの保存手順

1. VS Codeでこのフォルダを開く。  
2. ターミナルを開いて以下を順に実行：

```bash
git init
git add .
git commit -m "Initial commit: Add Excel VBA automation scripts"
git commit -m "Initial upload of VisitSheet Automation project"
git branch -M main
git remote add origin https://github.com/nylon0226/VisitSheet-Automation.git
git push -u origin main

MIT License
© 2025 nylon0226
